import{c as le,u as he,r as c,j as e,f as be,C as fe,s as v}from"./index-CdgcfNTE.js";import{b as q}from"./utils-C6qNh0Lg.js";import{R as te}from"./RichTextEditor-CSxRdF7u.js";import{u as se}from"./useModalControls-CwonU2Ci.js";import{P as ae}from"./plus-FG4UiPD-.js";import{S as ye}from"./search-3TF2MwGG.js";import{D as re}from"./download-uVwxRDeN.js";import{C as je}from"./clock-CATWwS4W.js";const ve=le("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),ne=le("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),H=[{value:"Agendada",label:"Agendada"},{value:"Em andamento",label:"Em curso"},{value:"Finalizada",label:"Finalizada"},{value:"Cancelada",label:"Cancelada"}],U=m=>{const p=m.trim().replace(/\s+/g," ");if(!p)return"";const h=p.split(" ");return h.length===1?h[0].slice(0,2).toUpperCase():`${h[0][0]||""}${h[h.length-1][0]||""}`.toUpperCase()},O=m=>{if(!m)return"--:--";const p=m.split(":");return p.length>=2?`${p[0].padStart(2,"0")}:${p[1].padStart(2,"0")}`:m},Ne=({options:m,value:p,onChange:h,placeholder:D="Selecione"})=>{const[z,I]=c.useState(!1),w=c.useRef(null),b=m.filter(l=>p.includes(l.value));return c.useEffect(()=>{const l=_=>{w.current&&(w.current.contains(_.target)||I(!1))};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]),e.jsxs("div",{className:"relative",ref:w,children:[e.jsxs("button",{type:"button",onClick:()=>I(l=>!l),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-left bg-white focus:ring-brand-500 outline-none",children:[b.length===0&&e.jsx("span",{className:"text-gray-400",children:D}),b.length>0&&e.jsxs("span",{className:"text-gray-700",children:[b.slice(0,2).map(l=>l.label).join(", "),b.length>2?` +${b.length-2}`:""]})]}),z&&e.jsxs("div",{className:"absolute z-20 mt-2 w-full max-h-64 overflow-auto rounded-xl border border-gray-200 bg-white shadow-lg",children:[m.map(l=>{const _=p.includes(l.value);return e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 text-sm hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:_,onChange:E=>{E.target.checked?h([...p,l.value]):h(p.filter(P=>P!==l.value))}}),e.jsxs("span",{className:"flex items-center gap-2",children:[l.avatar?e.jsx("img",{src:l.avatar,alt:l.label,className:"w-7 h-7 rounded-full object-cover"}):e.jsx("span",{className:"w-7 h-7 rounded-full bg-brand-50 text-brand-600 flex items-center justify-center text-xs font-semibold",children:U(l.label)}),e.jsxs("span",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium text-gray-800",children:l.label}),l.subLabel&&e.jsx("span",{className:"text-[11px] text-gray-400",children:l.subLabel})]})]})]},l.value)}),m.length===0&&e.jsx("p",{className:"px-3 py-3 text-sm text-gray-400",children:"Nenhum participante disponível."})]})]})},Le=()=>{const{effectiveClinicId:m,clinicUser:p,user:h,isSystemAdmin:D,role:z}=he(),[I,w]=c.useState([]),[b,l]=c.useState([]),[_,E]=c.useState([]),[P,F]=c.useState(!0),[B,k]=c.useState(!1),[A,C]=c.useState(null),[V,G]=c.useState(!1),[J,j]=c.useState(null),[i,S]=c.useState(null),ie=se({isOpen:B,onClose:()=>{k(!1),C(null)}}),de=se({isOpen:!!i,onClose:()=>S(null)}),[d,N]=c.useState({search:"",department:"",leaderId:"",meetingType:"",date:"",status:"",participantId:""}),[n,u]=c.useState({title:"",department:"",meetingType:"",meetingDate:"",meetingTime:"",status:"Agendada",meetingLink:"",conductorId:"",participantIds:[],agenda:"",nextSteps:""}),K=c.useMemo(()=>_.map(t=>t.name).sort(),[_]),Q=c.useMemo(()=>["Feedback","Alinhamento estratégico","Resultados","Equipe","Planejamento","Treinamento","Novos Projetos / Inovação","Avaliação de Desempenho","Outros"],[]),ce=c.useMemo(()=>b.map(t=>({value:t.id,label:t.name||t.email,subLabel:t.email,avatar:t.avatar_url})),[b]),f=c.useMemo(()=>I.filter(t=>{if(d.search){const s=d.search.toLowerCase();if(![t.title,t.department,t.meeting_type,t.conductor?.name].filter(Boolean).join(" ").toLowerCase().includes(s))return!1}return!(d.department&&t.department!==d.department||d.leaderId&&t.conductor_id!==d.leaderId||d.meetingType&&t.meeting_type!==d.meetingType||d.status&&t.status!==d.status||d.date&&t.meeting_date!==d.date||d.participantId&&!(t.participants||[]).some(o=>o.clinic_user_id===d.participantId))}),[I,d]),M=c.useMemo(()=>{const t=f.length,s=f.filter(a=>a.status==="Finalizada").length,o=f.filter(a=>a.status==="Em andamento").length,g=f.filter(a=>a.status==="Agendada").length;return{total:t,finished:s,ongoing:o,upcoming:g}},[f]),T=c.useMemo(()=>{const t={},s={},o={};f.forEach(a=>{const r=a.department||"Sem departamento",x=a.conductor?.name||"Sem líder",y=a.meeting_type||"Sem tipo";t[r]=(t[r]||0)+1,s[x]=(s[x]||0)+1,o[y]=(o[y]||0)+1});const g=a=>Object.entries(a).sort((r,x)=>x[1]-r[1]).slice(0,4);return{topDepartments:g(t),topLeaders:g(s),topTypes:g(o)}},[f]),W=t=>t==="Finalizada"?"bg-emerald-50 text-emerald-700":t==="Em andamento"?"bg-sky-50 text-sky-700":t==="Cancelada"?"bg-rose-50 text-rose-700":"bg-amber-50 text-amber-700",$=t=>t?H.find(o=>o.value===t)?.label||t:"Agendada",X=t=>{if(t==null)return"";const s=String(t);return/[";\n]/.test(s)?`"${s.replace(/"/g,'""')}"`:s},Y=t=>{const s=["Data","Hora","Título","Departamento","Tipo","Conduzida por","Status","Participantes"],o=f.map(r=>{const x=(r.participants||[]).map(y=>y.clinic_users?.name||y.clinic_users?.email||"").filter(Boolean).join(", ");return[q(r.meeting_date),O(r.meeting_time),r.title||"",r.department||"",r.meeting_type||"",r.conductor?.name||"",$(r.status),x]});if(t==="csv"){const x=`\uFEFF${[s.map(X).join(";"),...o.map(ge=>ge.map(X).join(";"))].join(`
`)}`,y=new Blob([x],{type:"text/csv;charset=utf-8;"}),ue=URL.createObjectURL(y),L=document.createElement("a");L.href=ue,L.setAttribute("download","reunioes-internas.csv"),document.body.appendChild(L),L.click(),document.body.removeChild(L);return}const g=o.map(r=>`<tr>${r.map(x=>`<td style="padding:6px;border:1px solid #ddd;font-size:12px;">${x}</td>`).join("")}</tr>`).join(""),a=window.open("","_blank");a&&(a.document.write(`
      <html><head><title>Relatório de reuniões</title>
      <style>table{border-collapse:collapse;width:100%;font-family:Arial;}th,td{border:1px solid #ddd;padding:6px;font-size:12px;}th{background:#f3f4f6;text-align:left;}</style>
      </head><body>
      <h3>Relatório de reuniões internas (filtrado)</h3>
      <table>
        <thead><tr>${s.map(r=>`<th>${r}</th>`).join("")}</tr></thead>
        <tbody>${g}</tbody>
      </table>
      </body></html>
    `),a.document.close(),a.print())},Z=t=>D||t.created_by&&t.created_by===h?.id?!0:z==="admin"||z==="owner",oe=async()=>{if(!m){l([]);return}const{data:t}=await v.from("clinic_users").select("id, name, email, avatar_url, user_id, ativo").eq("clinic_id",m).eq("ativo",!0).order("name",{ascending:!0});l(t||[])},me=async()=>{if(!m){E([]);return}const{data:t}=await v.from("hr_departments").select("id, name").eq("clinic_id",m).order("name",{ascending:!0});E(t||[])},R=async()=>{if(!m){w([]),F(!1);return}F(!0);const{data:t,error:s}=await v.from("hr_meetings").select(`
        *,
        conductor:clinic_users!hr_meetings_conductor_id_fkey (id, name, email, avatar_url),
        participants:hr_meeting_participants (
          clinic_user_id,
          clinic_users (id, name, email, avatar_url)
        )
      `).eq("clinic_id",m).order("meeting_date",{ascending:!1}).order("meeting_time",{ascending:!1});if(!s&&t){const o=p?.id,g=D?t:t.filter(a=>{if(!o)return!0;const r=(a.participants||[]).some(y=>y.clinic_user_id===o),x=a.created_by&&a.created_by===h?.id;return r||x});w(g)}F(!1)};c.useEffect(()=>{oe(),me()},[m]),c.useEffect(()=>{R()},[m]);const xe=()=>{C(null),j(null),u({title:"",department:"",meetingType:"",meetingDate:"",meetingTime:"",status:"Agendada",meetingLink:"",conductorId:"",participantIds:[],agenda:"",nextSteps:""}),k(!0)},ee=t=>{C(t.id),j(null),u({title:t.title||"",department:t.department||"",meetingType:t.meeting_type||"",meetingDate:t.meeting_date||"",meetingTime:t.meeting_time||"",status:t.status||"Agendada",meetingLink:t.meeting_link||"",conductorId:t.conductor_id||"",participantIds:(t.participants||[]).map(s=>s.clinic_user_id),agenda:t.agenda||"",nextSteps:t.next_steps||""}),k(!0)},pe=async t=>{if(t.preventDefault(),!m){j("Nenhuma clínica ativa para salvar reunião.");return}if(!n.title.trim()){j("Informe o título da reunião.");return}if(!n.meetingDate){j("Informe a data da reunião.");return}const s=Array.from(new Set([...n.participantIds,p?.id].filter(Boolean)));if(!s.length){j("Selecione ao menos um participante.");return}G(!0),j(null);try{const o={clinic_id:m,title:n.title.trim(),department:n.department||null,meeting_type:n.meetingType||null,meeting_date:n.meetingDate,meeting_time:n.meetingTime||null,status:n.status,meeting_link:n.meetingLink||null,agenda:n.agenda||null,next_steps:n.nextSteps||null,conductor_id:n.conductorId||null};let g=A;if(A){const{error:a}=await v.from("hr_meetings").update(o).eq("id",A);if(a)throw a}else{const a={...o,created_by:h?.id||null},{data:r,error:x}=await v.from("hr_meetings").insert(a).select("id").maybeSingle();if(x)throw x;g=r?.id||null}if(g){await v.from("hr_meeting_participants").delete().eq("meeting_id",g);const a=s.map(x=>({meeting_id:g,clinic_user_id:x})),{error:r}=await v.from("hr_meeting_participants").insert(a);if(r)throw r}k(!1),C(null),u({title:"",department:"",meetingType:"",meetingDate:"",meetingTime:"",status:"Agendada",meetingLink:"",conductorId:"",participantIds:[],agenda:"",nextSteps:""}),R()}catch(o){j(o?.message||"Erro ao salvar reunião.")}finally{G(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-brand-600 font-semibold",children:"Recursos Humanos"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Reuniões internas"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Registre decisões, participantes e próximos passos da equipe."})]}),e.jsxs("button",{type:"button",onClick:xe,className:"px-4 py-2 rounded-lg bg-brand-600 text-white text-sm hover:bg-brand-700 flex items-center gap-2",children:[e.jsx(ae,{size:16})," Adicionar reunião interna"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1.1fr_1fr] gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-white via-white to-brand-50 border border-brand-100 rounded-2xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-brand-100 text-brand-600 flex items-center justify-center",children:e.jsx(be,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Visão geral"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:"Acompanhamento das reuniões"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-slate-900 text-white p-3",children:[e.jsx("p",{className:"text-xs text-slate-200",children:"Total"}),e.jsx("p",{className:"text-lg font-semibold",children:M.total})]}),e.jsxs("div",{className:"rounded-xl bg-amber-50 border border-amber-100 p-3",children:[e.jsx("p",{className:"text-xs text-amber-600",children:"Agendadas"}),e.jsx("p",{className:"text-lg font-semibold text-amber-700",children:M.upcoming})]}),e.jsxs("div",{className:"rounded-xl bg-sky-50 border border-sky-100 p-3",children:[e.jsx("p",{className:"text-xs text-sky-600",children:"Em curso"}),e.jsx("p",{className:"text-lg font-semibold text-sky-700",children:M.ongoing})]}),e.jsxs("div",{className:"rounded-xl bg-emerald-50 border border-emerald-100 p-3",children:[e.jsx("p",{className:"text-xs text-emerald-600",children:"Finalizadas"}),e.jsx("p",{className:"text-lg font-semibold text-emerald-700",children:M.finished})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl p-5 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ye,{size:16,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{value:d.search,onChange:t=>N(s=>({...s,search:t.target.value})),placeholder:"Buscar por título, líder ou departamento",className:"w-full pl-9 pr-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-brand-500 outline-none"})]}),e.jsx("input",{type:"date",value:d.date,onChange:t=>N(s=>({...s,date:t.target.value})),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("select",{value:d.department,onChange:t=>N(s=>({...s,department:t.target.value})),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white",children:[e.jsx("option",{value:"",children:"Todos os departamentos"}),K.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:d.leaderId,onChange:t=>N(s=>({...s,leaderId:t.target.value})),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white",children:[e.jsx("option",{value:"",children:"Todos os líderes"}),b.map(t=>e.jsx("option",{value:t.id,children:t.name||t.email},t.id))]}),e.jsxs("select",{value:d.meetingType,onChange:t=>N(s=>({...s,meetingType:t.target.value})),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white",children:[e.jsx("option",{value:"",children:"Todos os tipos"}),Q.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:d.status,onChange:t=>N(s=>({...s,status:t.target.value})),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white",children:[e.jsx("option",{value:"",children:"Todos os status"}),H.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),e.jsxs("select",{value:d.participantId,onChange:t=>N(s=>({...s,participantId:t.target.value})),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white",children:[e.jsx("option",{value:"",children:"Todos os participantes"}),b.map(t=>e.jsx("option",{value:t.id,children:t.name||t.email},t.id))]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Apenas participantes marcados podem acessar a pauta da reunião."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>Y("pdf"),className:"px-3 py-1.5 text-xs rounded-full border border-gray-200 text-gray-600 flex items-center gap-2",children:[e.jsx(re,{size:14})," PDF"]}),e.jsxs("button",{type:"button",onClick:()=>Y("csv"),className:"px-3 py-1.5 text-xs rounded-full border border-gray-200 text-gray-600 flex items-center gap-2",children:[e.jsx(re,{size:14})," CSV"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl p-5",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Relatório por departamento"}),e.jsxs("div",{className:"space-y-2",children:[T.topDepartments.map(([t,s])=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:t}),e.jsx("span",{className:"font-semibold text-gray-800",children:s})]},t)),T.topDepartments.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:"Sem dados."})]})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl p-5",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Relatório por líder"}),e.jsxs("div",{className:"space-y-2",children:[T.topLeaders.map(([t,s])=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:t}),e.jsx("span",{className:"font-semibold text-gray-800",children:s})]},t)),T.topLeaders.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:"Sem dados."})]})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl p-5",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Relatório por tipo"}),e.jsxs("div",{className:"space-y-2",children:[T.topTypes.map(([t,s])=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:t}),e.jsx("span",{className:"font-semibold text-gray-800",children:s})]},t)),T.topTypes.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:"Sem dados."})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Histórico de reuniões"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Visualize reuniões em que você participou."})]}),e.jsxs("span",{className:"text-sm text-gray-400",children:[f.length," registros"]})]}),P?e.jsx("div",{className:"px-6 py-12 text-center text-sm text-gray-500",children:"Carregando reuniões..."}):e.jsxs("div",{className:"divide-y divide-gray-100",children:[f.map(t=>e.jsxs("div",{className:"px-6 py-4 flex flex-wrap items-center gap-4 hover:bg-gray-50 cursor-pointer",onClick:()=>S(t),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-[160px]",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-100 flex items-center justify-center text-gray-600",children:e.jsx(fe,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:q(t.meeting_date)}),e.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(je,{size:12})," ",O(t.meeting_time)]})]})]}),e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t.title}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.department||"Sem departamento"," • ",t.meeting_type||"Tipo não informado"]})]}),e.jsxs("div",{className:"flex items-center gap-3 min-w-[200px]",children:[t.conductor?.avatar_url?e.jsx("img",{src:t.conductor.avatar_url,alt:t.conductor.name,className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-50 text-brand-600 flex items-center justify-center text-xs font-semibold",children:U(t.conductor?.name||"CL")}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-800",children:t.conductor?.name||"Sem líder"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Conduzida por"})]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${W(t.status||"Agendada")}`,children:$(t.status)}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{type:"button",onClick:()=>S(t),className:"px-3 py-1 text-xs rounded-full border border-gray-200 text-gray-600 hover:border-gray-300",children:"Ver pauta"}),Z(t)&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>ee(t),className:"px-3 py-1 text-xs rounded-full border border-brand-100 text-brand-600 hover:border-brand-200",children:"Editar"}),e.jsx("button",{type:"button",onClick:async()=>{if(!confirm("Excluir reunião?"))return;const{error:s}=await v.from("hr_meetings").delete().eq("id",t.id);s||R()},className:"px-3 py-1 text-xs rounded-full border border-rose-100 text-rose-600 hover:border-rose-200",children:"Apagar"})]})]})]},t.id)),f.length===0&&e.jsx("div",{className:"px-6 py-12 text-center text-sm text-gray-400",children:"Nenhuma reunião encontrada com os filtros atuais."})]})]}),B&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:ie.onBackdropClick,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-3xl p-6 space-y-4",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:A?"Editar reunião":"Adicionar reunião"}),e.jsx("button",{type:"button",onClick:()=>{k(!1),C(null)},className:"w-9 h-9 rounded-full bg-gray-100 flex items-center justify-center text-gray-500",children:"✕"})]}),e.jsxs("form",{onSubmit:pe,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Título"}),e.jsx("input",{value:n.title,onChange:t=>u(s=>({...s,title:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-brand-500 outline-none",placeholder:"Título da reunião"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data"}),e.jsx("input",{type:"date",value:n.meetingDate,onChange:t=>u(s=>({...s,meetingDate:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hora"}),e.jsx("input",{type:"time",value:n.meetingTime,onChange:t=>u(s=>({...s,meetingTime:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento"}),e.jsxs("select",{value:n.department,onChange:t=>u(s=>({...s,department:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",children:[e.jsx("option",{value:"",children:"Selecione"}),K.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Link da reunião"}),e.jsxs("div",{className:"relative",children:[e.jsx(ne,{size:16,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{value:n.meetingLink,onChange:t=>u(s=>({...s,meetingLink:t.target.value})),className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg",placeholder:"https://meet..."})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Conduzida por"}),e.jsxs("select",{value:n.conductorId,onChange:t=>u(s=>({...s,conductorId:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",children:[e.jsx("option",{value:"",children:"Selecione"}),b.map(t=>e.jsx("option",{value:t.id,children:t.name||t.email},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Participantes"}),e.jsx(Ne,{options:ce,value:n.participantIds,onChange:t=>u(s=>({...s,participantIds:t})),placeholder:"Selecione os participantes"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de reunião"}),e.jsxs("select",{value:n.meetingType,onChange:t=>u(s=>({...s,meetingType:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",children:[e.jsx("option",{value:"",children:"Selecione"}),Q.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("select",{value:n.status,onChange:t=>u(s=>({...s,status:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",children:H.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assuntos / Pauta"}),e.jsx(te,{value:n.agenda,onChange:t=>u(s=>({...s,agenda:t})),placeholder:"Digite a pauta da reunião",minHeight:120})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Próximos passos"}),e.jsx(te,{value:n.nextSteps,onChange:t=>u(s=>({...s,nextSteps:t})),placeholder:"Defina os próximos passos",minHeight:120})]}),J&&e.jsx("div",{className:"p-3 bg-rose-50 text-rose-600 text-sm rounded-lg",children:J}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-xs text-gray-400 flex items-center gap-2",children:[e.jsx(ve,{size:14,className:"text-emerald-500"}),"Apenas participantes selecionados terão acesso à pauta."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{k(!1),C(null)},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:V,className:"px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 disabled:opacity-50 flex items-center gap-2",children:[V?e.jsx("span",{className:"animate-spin",children:"⏳"}):e.jsx(ae,{size:16}),A?"Salvar":"Adicionar"]})]})]})]})]})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:de.onBackdropClick,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-3xl p-6 space-y-4",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Reunião interna"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:i.title})]}),e.jsx("button",{type:"button",onClick:()=>S(null),className:"w-9 h-9 rounded-full bg-gray-100 flex items-center justify-center text-gray-500",children:"✕"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"rounded-xl border border-gray-100 p-3",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Data"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:q(i.meeting_date)})]}),e.jsxs("div",{className:"rounded-xl border border-gray-100 p-3",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Hora"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:O(i.meeting_time)})]}),e.jsxs("div",{className:"rounded-xl border border-gray-100 p-3",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Status"}),e.jsx("p",{className:`text-sm font-semibold ${W(i.status||"Agendada")}`,children:$(i.status)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-xl border border-gray-100 p-3 space-y-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Conduzida por"}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.conductor?.avatar_url?e.jsx("img",{src:i.conductor.avatar_url,alt:"",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-50 text-brand-600 flex items-center justify-center text-xs font-semibold",children:U(i.conductor?.name||"CL")}),e.jsx("span",{className:"text-sm text-gray-800",children:i.conductor?.name||"Sem líder"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Departamento"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:i.department||"Não informado"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Tipo de reunião"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:i.meeting_type||"Não informado"})]}),e.jsxs("div",{className:"rounded-xl border border-gray-100 p-3 space-y-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Participantes"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(i.participants||[]).map(t=>e.jsx("span",{className:"px-3 py-1 text-xs rounded-full bg-gray-100 text-gray-600",children:t.clinic_users?.name||t.clinic_users?.email||"Participante"},t.clinic_user_id)),(i.participants||[]).length===0&&e.jsx("span",{className:"text-xs text-gray-400",children:"Nenhum participante informado."})]}),i.meeting_link&&e.jsxs("a",{href:i.meeting_link,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-xs text-brand-600",children:[e.jsx(ne,{size:12})," Abrir link da reunião"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-xl border border-gray-100 p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Assuntos / Pauta"}),i.agenda?e.jsx("div",{className:"text-sm text-gray-700 rte-content",dangerouslySetInnerHTML:{__html:i.agenda}}):e.jsx("p",{className:"text-sm text-gray-700",children:"Sem pauta registrada."})]}),e.jsxs("div",{className:"rounded-xl border border-gray-100 p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Próximos passos"}),i.next_steps?e.jsx("div",{className:"text-sm text-gray-700 rte-content",dangerouslySetInnerHTML:{__html:i.next_steps}}):e.jsx("p",{className:"text-sm text-gray-700",children:"Nenhum próximo passo registrado."})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>S(null),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg",children:"Fechar"}),Z(i)&&e.jsx("button",{type:"button",onClick:()=>{S(null),ee(i)},className:"px-4 py-2 bg-brand-600 text-white rounded-lg",children:"Editar reunião"})]})]})})]})};export{Le as default};
